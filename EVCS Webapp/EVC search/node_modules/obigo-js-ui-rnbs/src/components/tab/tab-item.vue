<template>
  <a
    class="obg-tab-item"
    :class="[{
      'obg-tab-current': currentIndex === $parent.currentIndex,
      'obg-tab-icon': icon || $slots.icon,
      'disabled': disabled
    }]"
    @click="onItemClick"
    ref="item"
  >
    <span
      class="obg-tab-icon"
      :class="[{
        'icon-only': !($slots.default)
      }]"
      v-if="icon || $slots.icon">
      <slot name="icon">
        <i v-if="icon" :class="iconClass"></i>
      </slot>
    </span>
    <label class="obg-tab-text"><slot></slot></label>
    <div class="divider" :style="{'margin-left': (itemWidth - 1) +'px'}"/>
  </a>
</template>

<script>
  /**
   * @class tab-item
   * @classdesc components/tab-item
   * @desc tab-item
   * @param {boolean} [disabled=false]
   * @param {string} [icon]
   * @param {boolean} [selected]
   * @param {slot} [slot] label
   * @param {slot} [icon] icon
   *
   * @example
   * import {ButtonGroup,ButtonGroupItem} from 'obigo-js-ui/components/tab'
   * <obg-tab-item
   *  icon='more'
   *  selected
   * >
   *   tab1
   * </obg-tab-item>
   */
  import { childMixin } from '../../mixins/multi-items'

  export default {
    name: 'obg-tab-item',
    mixins: [childMixin],
    props: {
      icon: String,
      disabled: {
        type: Boolean,
        default: false
      }
    },
    computed: {
      iconClass: function () {
        return (this.currentIndex === this.$parent.currentIndex) ? 'obg-icon-' + this.icon + '-selected' : 'obg-icon-' + this.icon
      }
    },
    data () {
      return {
        itemWidth: 0
      }
    },
    mounted () {
      this.$on('jogclick', () => {
        this.onItemClick()
      })
      this.itemWidth = this.$el.offsetWidth
    },
    updated () {
      this.$nextTick(() => {
        this.itemWidth = this.$el.offsetWidth
        this.$refs.item.style.itemWidth = this.itemWidth / 2
      })
    }
  }
</script>

<style lang="scss">
  @import '../../styles/colors.variables.scss';
  .obg-tab-item{
    position: relative;
    flex:1;
    width: 135px;
    height: 78px;
    color: color(white);
    font-size: 20px;
    outline: none;
    user-select: none;
    align-items: center;
    justify-content: center;
    &.obg-focus {
      &:before{
        content:'';
        position:absolute;
        width:inherit;
        height:inherit;
        box-shadow: inset 0 0 0 3px color(white);
        display:block;
      }
    }
    &.obg-tab-icon {
      display: block;
      & > .obg-tab-icon {
        display: flex;
        height: 40px;
        justify-content: center;
        align-items: center;
        & > svg {
          height: 32px;
        }
        &.icon-only{
          height:auto;
        }
      }
      & > .obg-tab-text {
        display: block;
        text-align: center;
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
        padding: 0 10px 0 10px;
      }
    }
    &:active{
      background: color(secondary);
    }
    &.obg-tab-current{
      border-bottom: 5px solid color(primary);
      &:active{
        background: color(secondary);
      }
    }
    &.disabled{
      opacity: 0.5;
      pointer-events: none;
    }
    & > .divider{
      position:absolute;
      margin-top: -37px;
      width: 1px;
      height: 25px;
      background-color: $grey-7;
    }
    /*&:before{
      position:absolute;
      content:"";
      margin-top: 23px;
      margin-left:calc((var(--data-item-width) - 1) * 1px);
      width: 1px;
      height: 25px;
      background-color: $grey-7;
    }*/
  }


</style>
