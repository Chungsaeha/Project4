<template>
    <div class="overlay" >
        <div class="popup" @click.stop >
          <div class="pop-contents" >
            <h2 class="title" >
                {{title}}
            </h2>
            <div class='text-content' >{{content}}</div>
          </div>
          <div class="btn-area" >
              <button v-for="btn in buttons" :style="getBtnWidth()" @click="btn.onClick" >{{btn.label}}</button>
          </div>
        </div>
    </div>
</template>

<script>
import Vue from 'vue'
/**
 * popup
 * @class popup
 * @classdesc components/popup
 * @param {object} options                      - options to show
 * @param {string} options.title                - title for popup
 * @param {string} options.content              - text content for popup
 * @param {array} options.buttons               - popup buttons. if no buttons, popup will be close in 5sec automatically.
 * @param {string} options.buttons.label        - popup button label
 * @param {string} options.buttons.onClick      - popup button click handler
 */
export default {
  name: 'obg-popup',
  methods: {
    close () {
      if (this.componentContent) {
        this.componentContent.$destroy()
      }
      this.$root.$destroy()
      this.$root.$el.parentNode.removeChild(this.$root.$el)
    },
    getBtnWidth () {
      return {
        width: (100 / this.buttons.length) + '%'
      }
    }
  },
  data () {
    return {
      timeout: 5000
    }
  },
  props: {
    buttons: {
      type: Array
    },
    title: {
      type: String
    },
    content: {
      type: String
    }
  },
  mounted () {
    if (typeof this.content === 'object') {
      var props = this.content.props
      this.componentContent = new Vue({
        el: this.$el.querySelector('.component-content'),
        render: h => h(this.content.component, {props})
      })
    }
    if (!this.buttons || this.buttons.length === 0) {
      setTimeout(this.close, this.timeout)
    }
    this.$root.closePopup = this.close
  }
}
</script>

<style lang="scss" scoped >
@import '../../styles/colors.variables.scss';
.overlay{
    position:fixed;
    width:100%;
    height:100%;
    top:0;
    left:0;
    z-index:100;
    background-color:rgba(0, 0, 0, 0.4);
    display:flex;
    align-items:center;
    justify-content:center;
    color:white;

    .popup{
        flex:none;
        width:518px;
        min-height:200px;
        border:1px solid #737480;
        font-size:32px;
        flex-direction:column;
        display:flex;
        background:#2a2a2a;
        .pop-contents{
          text-align:center; padding-bottom:10px;
          .title{
              font-size:32px; line-height:66px;
              text-align:center;
          }
          .text-content{
              margin:16px 23px;
              line-height:39px;
              flex:1;
              text-align:center;
              white-space:pre-wrap;
              word-wrap: break-word;
          }
        }
        .btn-area{
            height:60px;
            button{
                margin:0;
                background:none;
                color:white;
                border:none;
                border-top:1px solid $grey-7;
                border-right:1px solid $grey-7;
                box-shadow:none;
                height:60px;
                font-size:32px;
                line-height:52px;
                &:last-child{
                    border-right:none;
                }
                &.focus{
                  box-shadow: inset 0 0 0 3px color(white);
                }
                &:active{
                    background-color:color(secondary);
                }
            }
        }
    }
}
</style>
