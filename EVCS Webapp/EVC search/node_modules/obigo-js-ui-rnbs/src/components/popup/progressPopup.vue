<template>
    <div class="overlay" >
        <div class="popup" @click.stop >
          <div class='pop-contents' >
            <div class="title" >
                {{title}}
            </div>
            <div class="content" >
                <div  class='text-content' >{{content}}</div>
                <div class='progress-area' >
                  <div class='progress-bar' >
                    <div class='bar-outline' >
                      <div class='bar-gauge' :style='{width:barWidth+"%"}'  ></div>
                    </div>
                  </div>
                  <div class='progress-text'>
                    {{barWidth}}%
                  </div>
                </div>
            </div>
          </div>
          <div class="btn-area" >
              <button @click="button.onClick" >{{button.label}}</button>
          </div>
        </div>
    </div>
</template>

<script>
/**
 * progress-popup
 * @class progressPopup
 * @classdesc components/popup
 * @param {object} options                      - options to show
 * @param {object} options.progress             - progress bar value 0 ~ 100
 * @param {string} options.title                - title for popup
 * @param {string} options.content              - text content for popup
 * @param {string} options.button.label         - popup button label
 * @param {string} options.button.onClick       - popup button click handler
 */
export default {
  name: 'obg-progress-popup',
  methods: {
    close () {
      if (this.componentContent) {
        this.componentContent.$destroy()
      }
      this.$root.$destroy()
      this.$root.$el.parentNode.removeChild(this.$root.$el)
    },
    updateProgress (width) {
      this.barWidth = width
    }
  },
  data () {
    return {
      barWidth: 0
    }
  },
  props: {
    button: {
      type: Object
    },
    title: {
      type: String
    },
    content: {
      type: String
    },
    progress: {
      type: Number,
      validator: function (value) {
        return value >= 0 && value <= 100
      }
    }
  },
  mounted () {
    if (this.progress !== undefined) {
      this.updateProgress(this.progress)
    }
    this.$root.closePopup = this.close
    this.$root.updateProgress = this.updateProgress
  }
}
</script>

<style lang="scss" scoped >
@import '../../styles/colors.variables.scss';
.overlay{
    position:fixed;
    width:100%;
    height:100%;
    top:0;
    left:0;
    z-index:100;
    background-color:rgba(0, 0, 0, 0.4);
    display:flex;
    align-items:center;
    justify-content:center;
    color:white;

    .popup{
        flex:none;
        width:518px;
        min-height:200px;
        border:1px solid #737480;
        background:#2a2a2a;
        flex-direction:column;
        display:flex;

        .pop-contents{
          text-align:center; padding-bottom:10px;
          .title{
              font-size:32px; line-height:66px;
              text-align:center;
          }
          .content{
              padding:10px 10px;
              flex:1;
              margin:16px 23px;
              line-height:39px;
              .text-content{
                  font-size:32px; 
                  flex:1;
                  text-align:center;
                  white-space:pre-wrap;
                  word-wrap: break-word;
              }
              .progress-area{
                margin-top:10px;
                display:flex;
                font-size:18px;
                flex-direction:row;
                justify-content:center;
                align-items:center;
                height:30px;
                & > div{
                  margin-left:4px;
                  margin-right:4px;
                }

                .progress-bar{
                  width:90%;
                  .bar-outline{
                    border:1px solid #737480;
                    height:20px;
                    background-color:#595959;

                    .bar-gauge{
                      height:100%;
                      background-color:#00d4ff;
                    }
                  }
                }
                .progress-text{
                  width:10%;
                }
              }
          }
        }
        .btn-area{
            button{
                width:100%;
                margin:0;
                background:none;
                color:white;
                border:none;
                border-top:1px solid $grey-7;
                border-right:1px solid $grey-7;
                box-shadow:none;
                height:60px;
                font-size:32px;
                line-height:52px;
                &:last-child{
                    border-right:none;
                }
                &.focus{
                  box-shadow: inset 0 0 0 3px color(white);
                }
                &:active{
                    background-color:color(secondary);
                }
            }
        }
    }
}
</style>
