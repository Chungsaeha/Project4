<template>
  <div
    class="obg-playtime"
    :class="{ 'obg-playtime-disabled': disabled }"
    :style="{ 'width': playtimeWidth + 'px'}"
  >
    <div class="obg-playtime-label start">
      {{minTime}}
    </div>
    <obg-slider
      :min="min"
      :max="max"
      :barHeight="barHeight"
      :sliderWidth="sliderWidth"
      :focus="focus"
      :thumbLabel="false"
      v-model="model"
      @input="onInput"
    ></obg-slider>
    <div class="obg-playtime-label end">
      {{maxTime}}
    </div>
  </div>
</template>
<script type="text/babel">
  /**
   * @class playtime
   * @classdesc components/playtime
   * @param {number} [min=0]
   * @param {number} [max=100]
   * @param {number} [step=1]
   * @param {number} [value=0]
   * @param {number} [barHeight=5]
   * @param {number} [sliderWidth=500]
   * @param {number} [playtimeWidth=500]
   * @param {boolean} [draggable=true]
   * @param {boolean} [disabled=false]
   * @event {number} [input]
   *
   * @example
   * import playtime from 'obigo-js-ui/components/playtime'
   * <obg-playtime
   *  v-model="model"
   *  :min="0"
   *  :max="100"
   *  @input="onInput"
   *  ></obg-playtime>
   */
  import slider from '../slider'
  import Utils from '../../utils'

  export default {
    name: 'obg-playtime',
    components: {
      'obg-slider': slider
    },
    props: {
      min: {
        type: Number,
        default: 0
      },
      max: {
        type: Number,
        default: 100
      },
      disabled: {
        type: Boolean,
        default: false
      },
      value: {
        type: Number,
        default: 0
      },
      barHeight: {
        type: Number
      },
      sliderWidth: {
        type: Number,
        default: 525
      },
      playtimeWidth: {
        type: Number,
        default: 800
      }
    },
    computed: {
      minTime () {
        if (this.value === 0) {
          return Utils.time.secToTime(this.min)
        }
        return Utils.time.secToTime(this.value)
      }
    },
    data () {
      return {
        model: (this.value < this.min) ? this.min : this.value,
        focus: false,
        maxTime: Utils.time.secToTime(this.max)
      }
    },
    mounted () {
      this.$on('jogclick', () => {
        this.focus = !(this.focus)
        if (this.focus) {
            // TODO add jog event listner - value up/down
        } else {
            // TODO remove jog event
        }
      })
      this.$on('focusout', () => {
        this.focus = false
      })
    },
    methods: {
      onInput (val) {
        this.$emit('input', val)
      }
    }
  }
</script>
<style lang="scss" scoped>
  @import '../../styles/colors.variables.scss';
  .obg-playtime {
    position: relative;
    display: flex;
    height: 40px;
    line-height: 40px;
    color:color(black);
    text-align:center;
    padding: 5px 40px 5px 40px;
    & > .obg-slider{
      margin: 0 auto;
    }
    & > .obg-playtime-label{
      color: #8a8a99;
      font-size: 20px;
    }
    &.obg-playtime-disabled {
      opacity: 0.5;
      user-select: none;
      pointer-events: none;
    }
  }

</style>
